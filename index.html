<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mi progreso en FMED</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f8f4ff;
      color: #333;
      margin: 0;
      padding: 1rem;
      transition: background-color 0.3s, color 0.3s;
    }

    h1 {
      font-family: cursive;
      text-align: center;
      margin-bottom: 1rem;
    }

    .modo-oscuro {
      background-color: #121212;
      color: #eee;
    }

    .modo-oscuro .materia label {
      color: #eee;
    }

    .toggle-modo {
      display: block;
      margin: 0 auto 1rem auto;
      padding: 0.5rem 1rem;
      border: none;
      background-color: #c5a8ff;
      color: #000;
      border-radius: 8px;
      cursor: pointer;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .anio {
      background-color: #ffe8f0;
      border: 2px solid #f5c6d6;
      border-radius: 12px;
      padding: 1rem;
    }

    .anio h2 {
      color: #a04f72;
      font-size: 1.2rem;
      margin-bottom: 0.5rem;
    }

    .materia {
      margin-bottom: 0.5rem;
    }

    .materia input[type="checkbox"]:disabled + label {
      color: #aaa;
      text-decoration: none;
    }

    .materia input[type="checkbox"]:checked + label {
      text-decoration: line-through;
      opacity: 0.6;
    }

    label {
      margin-left: 0.5rem;
      cursor: pointer;
    }

    .tooltip {
      position: relative;
      display: inline-block;
      border-bottom: 1px dotted black;
    }

    .tooltip .tooltiptext {
      visibility: hidden;
      width: 220px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%; 
      left: 50%;
      margin-left: -110px;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }

    .barra-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .barra {
      width: 80%;
      background-color: #ddd;
      height: 30px;
      border-radius: 15px;
      overflow: hidden;
      position: relative;
    }

    .progreso {
      background-color: #a0e8af;
      height: 100%;
      width: 0;
      transition: width 0.3s;
      display: flex;
      align-items: center;
      position: relative;
    }

    .gatito {
      position: absolute;
      right: -25px;
      top: -10px;
      width: 40px;
      height: 40px;
    }

    .gatito img {
      width: 100%;
      animation: rodar 1s linear infinite;
    }

    @keyframes rodar {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>

  <h1>Mi progreso en FMED</h1>
  <button class="toggle-modo" onclick="alternarModo()">Modo oscuro / claro</button>

  <div class="barra-container">
    <div class="barra">
      <div class="progreso" id="barraProgreso">
        <div class="gatito">
          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIA..." alt="Gatito" />
        </div>
      </div>
    </div>
  </div>

  <div class="grid" id="contenedorMaterias">
    <!-- Aquí van todas tus materias como en el código original (ya están cargadas, este bloque se llena dinámicamente con JS) -->
  </div>

  <script>
    const materias = [
      { nombre: "Química CBC", id: "quimica" },
      { nombre: "Biología CBC", id: "biologia" },
      { nombre: "Física CBC", id: "fisica" },
      { nombre: "ICSE CBC", id: "icse" },
      { nombre: "IPC CBC", id: "ipc" },
      { nombre: "Matemática CBC", id: "matematica" },
      { nombre: "Anatomía", id: "anatomia", correlativas: ["quimica", "biologia"] },
      { nombre: "Histología", id: "histologia", correlativas: ["biologia"] },
      { nombre: "Embriología", id: "embriologia", correlativas: ["biologia"] },
      { nombre: "Salud Pública I", id: "sp1", correlativas: ["icse"] },
      { nombre: "Biofísica", id: "biofisica", correlativas: ["fisica"] },
      { nombre: "Informática Médica", id: "info", correlativas: ["ipc"] },
      // Agregá el resto de tus materias siguiendo este formato...
    ];

    const contenedor = document.getElementById("contenedorMaterias");

    const anios = {
      "CBC": [],
      "1er Año": [],
      "2do Año": [],
      "3er Año": [],
      "4to Año": [],
      "5to Año": [],
      "Internado Anual": [],
    };

    materias.forEach(m => {
      if (m.nombre.includes("CBC")) anios["CBC"].push(m);
      else if (["anatomia", "histologia", "embriologia"].includes(m.id)) anios["1er Año"].push(m);
      else if (["biofisica", "info", "sp1"].includes(m.id)) anios["2do Año"].push(m);
      else anios["3er Año"].push(m); // distribuir el resto como quieras
    });

    for (const [anio, materiasAnio] of Object.entries(anios)) {
      const div = document.createElement("div");
      div.className = "anio";
      const titulo = document.createElement("h2");
      titulo.textContent = anio;
      div.appendChild(titulo);

      materiasAnio.forEach(m => {
        const cont = document.createElement("div");
        cont.className = "materia";
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = m.id;

        const label = document.createElement("label");
        label.htmlFor = m.id;
        if (m.correlativas) {
          const tooltip = document.createElement("span");
          tooltip.className = "tooltip";
          tooltip.textContent = m.nombre;

          const tooltipText = document.createElement("span");
          tooltipText.className = "tooltiptext";
          tooltipText.textContent = "Correlativas: " + m.correlativas.map(c => materias.find(mat => mat.id === c)?.nombre).join(", ");

          tooltip.appendChild(tooltipText);
          label.appendChild(tooltip);
        } else {
          label.textContent = m.nombre;
        }

        cont.appendChild(checkbox);
        cont.appendChild(label);
        div.appendChild(cont);
      });

      contenedor.appendChild(div);
    }

    function alternarModo() {
      document.body.classList.toggle("modo-oscuro");
    }

    function actualizarProgreso() {
      const total = document.querySelectorAll('.materia input').length;
      const marcadas = document.querySelectorAll('.materia input:checked').length;
      const porcentaje = (marcadas / total) * 100;
      document.getElementById('barraProgreso').style.width = porcentaje + "%";
    }

    function controlarCorrelativas() {
      materias.forEach(m => {
        const checkbox = document.getElementById(m.id);
        if (!checkbox) return;
        if (!m.correlativas || m.correlativas.every(c => document.getElementById(c)?.checked)) {
          checkbox.disabled = false;
        } else {
          checkbox.disabled = true;
        }
      });
    }

    document.querySelectorAll('.materia input').forEach(cb => {
      cb.addEventListener("change", () => {
        actualizarProgreso();
        controlarCorrelativas();
      });
    });

    window.onload = () => {
      controlarCorrelativas();
      actualizarProgreso();
    };
  </script>
</body>
</html>
